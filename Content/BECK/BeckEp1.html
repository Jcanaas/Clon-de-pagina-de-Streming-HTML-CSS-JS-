<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../../css/estilos.css">
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
  <title>JoJo-Flix</title>
  <link rel="icon" href="../../favicon.ico" type="image/x-icon">
</head>
<body>
<header>
  <div class="contenedor">
    <h2 class="logotipo" onclick="location.href='../../index.html'">JoJo-flix</h2>
    <nav>
      <a href="../../index.html" class="activo">Inicio</a>
      <a href="../../index.html">Programas</a>
      <a href="../../index.html">Películas</a>
      <a href="../../index.html">Más Recientes</a>
      <a href="../../index.html">Mi lista</a>
    </nav>
  </div>
</header>

<main>
  <div class="pelicula-principalBECK">
    <div class="contenedor">
      <h3 class="titulo">
        <img src="../../img/Beck.png" alt="BECK: Mongolian Chop Squad">
      </h3>
      <div class="texto">
        <p class="descripcion">
          Yukio Tanaka, conocido por todos como Koyuki, es un chico de catorce años insatisfecho con el rumbo que de momento parece llevar su monótona vida. Sin embargo, todo dará un vuelco cuando el joven salva a un perro de extraña apariencia de unos macarras y conoce a su dueño, Minami Ryûsuke.
        </p>
      </div>
    </div>
  </div>
  
  <div class="episodio">
    <h3 class="titulo-episodio">1. El escenario de un chaval de 14 años</h3>
    <div class="video-container">
      <iframe width="1600" height="900" frameborder="0" src="https://mega.nz/embed/UeMQlRoR#EwlxBorqdNokJXjM0G2JsHlU9dSa9YwZhjnAG2ArWe0" allowfullscreen></iframe>
    </div>
    <div class="boton-container">
      <button role="button" class="boton" onclick="location.href='BECK_List_Ep.html'"><i class="fas fa-backward"></i> Capítulo Anterior</button>
      <button role="button" class="boton" onclick="location.href='BeckEp2.html'"><i class="fas fa-forward"></i> Siguiente Episodio</button>
    </div>
  </div>
</main>

<footer>
  <br><br>
  <br><br>
  <br><br>
  <br><br>
  <br><br>
  <p>2025 JoJo-Flix. Todos los derechos reservados.</p>
</footer>

<script src="https://kit.fontawesome.com/2c36e9b7b1.js" crossorigin="anonymous"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const usuario = localStorage.getItem("usuario"); // Obtener el usuario del localStorage
    const episodeTitleElement = document.querySelector('.titulo-episodio'); // Seleccionar el h3 con la clase 'titulo-episodio'
    const episodeTitle = episodeTitleElement ? episodeTitleElement.textContent.trim() : "Título no encontrado"; // Obtener el texto del h3

    // Extraer el número y el título del episodio
    const episodeMatch = episodeTitle.match(/^(\d+)\.\s*(.+)$/); // Regex para capturar número y título
    const episodeBeck = episodeMatch ? `${episodeMatch[1]} - ${episodeMatch[2]}` : episodeTitle; // Formato "número - título"

    const data = {
        accion: 'episodioBeck',
        usuario: usuario,
        episodeBeck: episodeBeck
    };

    console.log('Datos enviados:', data);

    const scriptURL = 'https://script.google.com/macros/s/AKfycbzsORwapCu088hn1FW4aFLSxJas6lJp0VPK6nwJbWMhsS2T_AoGdiAt9jKXqUGaa6jfaQ/exec';

    // Enviar datos al Google Apps Script
    fetch(scriptURL, {
        method: 'POST',
        body: JSON.stringify(data), // Enviar datos como JSON
        headers: {
            'Content-Type': 'text/plain;charset=utf-8' // Encabezado simple para evitar preflight
        }
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Error en la solicitud: ' + response.status);
        }
        return response.json(); // Procesar la respuesta como JSON
    })
    .then(data => {
        console.log('Respuesta del servidor:', data);
    })
    .catch(error => {
        console.error('Error al enviar los datos:', error);
    });

    console.log(`Episodio enviado: ${episodeBeck}`);
});
</script>
</body>
</html>
